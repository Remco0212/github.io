<!DOCTYPE html>
<html lang="en">

<head>
    <title>Bootstrap Example</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
</head>
<style>
    .background {
        width: 100vw;
        height: 100vh;
        position: relative;
    }

    .application {
        position: absolute;
        z-index: 1;
        left: 0;
        right: 0;
    }

    .container {
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    .container-row {
        display: flex;
    }

    input.form-control {
        width: 100px;
        height: 100px;
        text-align: center;
        font-size: 10rem;
        margin: 10px;
        text-transform: uppercase;
    }

    input.form-control.correct {
        background: green;
    }

    input.form-control.present {
        background: orange;
    }

    input.form-control.absent {
        background: gray;
    }
</style>

<body>
    <div class="application">
        <div class="container">
            <div class="container-row active">
                <div class="form-group">
                    <input class="form-control">
                </div>
                <div class="form-group">
                    <input class="form-control">
                </div>
                <div class="form-group">
                    <input class="form-control">
                </div>
                <div class="form-group">
                    <input class="form-control">
                </div>
                <div class="form-group">
                    <input class="form-control">
                </div>
            </div>
        </div>
    </div>
    <img class="background" src="assets/sinterklaas-achtergrond.jpg">
</body>
<script>
    let usedWords = [];

    const words = [
        'stoom',
        'pakje',
        'piet',
        'pruik',
        'feest',
        'spijs',
        'sint',
        'zwart',
        'daken',
        'kind',
        'stout',
        'snoep',
        'geven',
        'boot',
        'rijm',
        'wens',
        'cacao',
        'kruid'
    ];

    const maxTries = 6;
    let randomWord = '';
    let playedGames = 0;

    function newInput() {
        const group = document.createElement('div');
        group.className = "form-group";

        const input = document.createElement('input');
        input.className = "form-control";
        input.maxLength = 1;
        group.appendChild(input);

        return group;
    }

    function prepareInputs() {
        let containerRow = document.querySelector('.container-row.active');

        if (!containerRow) {
            const container = document.querySelector('.container');
            containerRow = document.createElement('div');
            containerRow.className = "container-row active";
            container.appendChild(containerRow);
        }

        while (containerRow.firstChild) {
            containerRow.removeChild(containerRow.firstChild);
        }

        for (let i = 0; i < randomWord.length; i++) {
            let input = newInput();
            containerRow.appendChild(input);

            if (i === 0) {
                input.firstChild.focus();
            }

            input.addEventListener('input', (e) => {
                if (e.target.parentElement.nextSibling) {
                    e.target.parentElement.nextSibling.firstChild.focus();
                } else if (e.target.value) {
                    validateWord();
                }
            });
        }
    }

    function init() {
        randomWord = words[Math.floor(Math.random() * words.length)];

        if (usedWords.includes(randomWord)) {
            init();
        }

        usedWords.push(randomWord);

        const container = document.querySelector('.container');
        while (container.firstChild) {
            container.removeChild(container.firstChild);
        }

        prepareInputs();
    }

    function validateWord() {
        const container = document.querySelector('.container-row.active');

        let guessedWord = '';
        for (let i = 0; i < randomWord.length; i++) {
            const input = container.children[i].querySelector('input');
            input.disabled = true;

            if (input.value === randomWord[i]) {
                input.classList.add('correct');
            } else if (randomWord.includes(input.value)) {
                input.classList.add('present');
            } else {
                input.classList.add('absent');
            }

            guessedWord += container.children[i].querySelector('input').value;
        }

        if (guessedWord === randomWord) {
            playedGames++;
            if (playedGames < 12 && confirm('Je hebt gewonnen, speel nogmaals voor een extra cadeau')) {
                init();
            }
        } else if (container.parentElement.childNodes.length < maxTries) {
            container.classList.remove('active');

            prepareInputs();
        } else {
            confirm(`Helaas je hebt het niet gehaald binnen het aantal beurten. Het woord was '${randomWord}'`)
        }
    }

    init();
</script>

</html>
